{% extends 'base.html' %}

{% block title %}Disponibilidad de Espacios - MiParqueo{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1 class="display-6">
            <i class="bi bi-grid-3x3-gap text-primary"></i> 
            Disponibilidad de Espacios
        </h1>
        <p class="text-muted">Seleccione un espacio libre para realizar una reserva</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="alert alert-info">
            <i class="bi bi-info-circle-fill"></i>
            <strong>Leyenda:</strong>
            <span class="badge bg-success ms-2">LIBRE</span>
            <span class="badge bg-warning text-dark ms-2">RESERVADO</span>
            <span class="badge bg-danger ms-2">OCUPADO</span>
            <span class="badge bg-secondary ms-2">BLOQUEADO</span>
        </div>
    </div>
</div>

<div class="row g-3">
    {% for espacio in espacios %}
    <div class="col-md-4 col-lg-3">
        <div class="card {% if espacio.estado == 'LIBRE' %}border-success{% elif espacio.estado == 'OCUPADO' %}border-danger{% elif espacio.estado == 'RESERVADO' %}border-warning{% else %}border-secondary{% endif %}">
            <div class="card-body text-center">
                <h3 class="card-title">
                    {% if espacio.tipo == 'CARRO' %}
                    <i class="bi bi-car-front-fill text-primary"></i>
                    {% elif espacio.tipo == 'MOTO' %}
                    <i class="bi bi-bicycle text-warning"></i>
                    {% else %}
                    <i class="bi bi-universal-access text-info"></i>
                    {% endif %}
                </h3>
                <h4 class="fw-bold">Espacio {{ espacio.numero }}</h4>
                <p class="text-muted mb-2">{{ espacio.get_tipo_display }}</p>
                
                <span class="badge badge-estado 
                    {% if espacio.estado == 'LIBRE' %}bg-success
                    {% elif espacio.estado == 'OCUPADO' %}bg-danger
                    {% elif espacio.estado == 'RESERVADO' %}bg-warning text-dark
                    {% else %}bg-secondary{% endif %}">
                    {{ espacio.get_estado_display }}
                </span>
                
                {% if espacio.estado == 'LIBRE' %}
                <div class="mt-3">
                    <a href="{% url 'cliente_crear_reserva' espacio.id %}" 
                       class="btn btn-success btn-sm w-100">
                        <i class="bi bi-calendar-plus"></i> Reservar
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="alert alert-warning">
            <i class="bi bi-exclamation-triangle"></i>
            No hay espacios de parqueadero registrados en el sistema.
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

